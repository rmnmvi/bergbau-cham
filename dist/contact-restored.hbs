<!DOCTYPE html>
<html lang="{{#if isFrench}}fr{{else}}en{{/if}}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{#if isFrench}}Contactez-nous{{else}}Contact Us{{/if}} - Edelmetall Cham</title>
    <meta name="description" content="{{#if isFrench}}Contactez Edelmetall Cham pour tous vos besoins en mÃ©taux prÃ©cieux. Nous sommes lÃ  pour vous aider avec l'achat, la vente et la consultation d'experts.{{else}}Get in touch with Edelmetall Cham for all your precious metals trading needs. We're here to help with buying, selling, and expert consultation.{{/if}}">
    <link href="/styles.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&display=swap');
        .font-sans-body { font-family: 'Open Sans', sans-serif; }
        .btn-primary {
            background-color: #D4AF37;
            color: #111827;
            padding: 16px 32px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.2s;
            display: inline-block;
            text-align: center;
            width: 100%;
        }
        .btn-primary:hover {
            background-color: #B8941F;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(212, 175, 55, 0.3);
        }
        .btn-primary:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Custom Captcha Styles */
        .custom-captcha {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            user-select: none;
            width: fit-content;
        }
        
        .custom-captcha:hover {
            border-color: #D4AF37;
            background: #fffef5;
        }
        
        .custom-captcha.verified {
            border-color: #10b981;
            background: #f0fdf4;
            cursor: default;
        }
        
        .captcha-checkbox {
            width: 28px;
            height: 28px;
            margin-right: 12px;
            position: relative;
        }
        
        .captcha-checkbox svg {
            width: 100%;
            height: 100%;
        }
        
        .captcha-checkmark {
            opacity: 0;
            transform: scale(0);
            transition: all 0.3s ease;
        }
        
        .custom-captcha.verified .captcha-checkmark {
            opacity: 1;
            transform: scale(1);
            animation: checkmarkPop 0.4s ease;
        }
        
        @keyframes checkmarkPop {
            0% {
                transform: scale(0);
            }
            50% {
                transform: scale(1.2);
            }
            100% {
                transform: scale(1);
            }
        }
        
        .captcha-text {
            font-size: 14px;
            color: #374151;
            font-weight: 500;
        }
        
        .custom-captcha.verified .captcha-text {
            color: #10b981;
        }
        
        /* Honeypot field - hidden from users */
        .website-field {
            position: absolute;
            left: -9999px;
            top: -9999px;
            height: 0;
            width: 0;
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body class="font-sans-body">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <!-- Logo/Company Name -->
                <div class="flex items-center">
                    <a href="{{#if isFrench}}/fr{{else}}/{{/if}}" class="flex items-center">
                        <img src="/assets/images/logo/logo_black.svg" alt="Edelmetall Cham Logo" class="h-10 w-auto">
                    </a>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="{{#if isFrench}}/fr/contact.html{{else}}/contact.html{{/if}}" class="text-gold font-semibold">{{#if isFrench}}Contact{{else}}Contact{{/if}}</a>
                    <a href="{{#if isFrench}}/fr/quote.html{{else}}/quote.html{{/if}}" class="bg-gold text-gray-900 px-4 py-2 rounded-md font-semibold hover:bg-gold-light transition">{{#if isFrench}}Devis / Demande{{else}}Quote / Inquire{{/if}}</a>

                    <!-- Language Switcher -->
                    <div class="flex items-center border-l pl-6 ml-6">
                        {{#if isFrench}}
                        <a href="/contact.html" class="text-gray-700 hover:text-gold transition flex items-center">
                            <span class="mr-1">ðŸ‡¬ðŸ‡§</span> EN
                        </a>
                        {{else}}
                        <a href="/fr/contact.html" class="text-gray-700 hover:text-gold transition flex items-center">
                            <span class="mr-1">ðŸ‡«ðŸ‡·</span> FR
                        </a>
                        {{/if}}
                    </div>
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button onclick="toggleMobileMenu()" class="text-gray-700">
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Mobile Menu -->
            <div id="mobileMenu" class="hidden md:hidden">
                <div class="px-2 pt-2 pb-3 space-y-1">
                    <a href="{{#if isFrench}}/fr/contact.html{{else}}/contact.html{{/if}}" class="block px-3 py-2 text-gold font-semibold">{{#if isFrench}}Contact{{else}}Contact{{/if}}</a>
                    <a href="{{#if isFrench}}/fr/quote.html{{else}}/quote.html{{/if}}" class="block px-3 py-2 bg-gold text-gray-900 rounded-md font-semibold">{{#if isFrench}}Devis / Demande{{else}}Quote / Inquire{{/if}}</a>
                    <div class="border-t mt-3 pt-3">
                        {{#if isFrench}}
                        <a href="/contact.html" class="block px-3 py-2 text-gray-700 hover:text-gold">
                            <span class="mr-1">ðŸ‡¬ðŸ‡§</span> English
                        </a>
                        {{else}}
                        <a href="/fr/contact.html" class="block px-3 py-2 text-gray-700 hover:text-gold">
                            <span class="mr-1">ðŸ‡«ðŸ‡·</span> FranÃ§ais
                        </a>
                        {{/if}}
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Contact Section -->
    <section class="py-20 bg-white" id="contactSection">
        <div class="container mx-auto px-6">
            <h1 class="font-sans-body text-4xl md:text-5xl font-bold text-center mb-12">
                {{#if isFrench}}Connectons-nous{{else}}Let's Connect{{/if}}
            </h1>
            <div class="max-w-2xl mx-auto">
                <form id="contactForm" class="space-y-6" action="/api/submit-contact" method="POST">
                    <div>
                        <label for="name" class="block text-sm font-medium text-gray-700 mb-2">{{#if isFrench}}Nom *{{else}}Name *{{/if}}</label>
                        <input type="text" name="name" id="name" required
                               placeholder="{{#if isFrench}}Jean Dupont{{else}}John Doe{{/if}}"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gold focus:border-transparent">
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-2">{{#if isFrench}}Email *{{else}}Email *{{/if}}</label>
                        <input type="email" name="email" id="email" required
                               placeholder="{{#if isFrench}}jean@exemple.com{{else}}john@example.com{{/if}}"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gold focus:border-transparent">
                    </div>
                    <div>
                        <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">{{#if isFrench}}NumÃ©ro de tÃ©lÃ©phone *{{else}}Phone Number *{{/if}}</label>
                        <input type="tel" name="phone" id="phone" required
                               placeholder="+49 123 456 7890"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gold focus:border-transparent">
                    </div>
                    <div>
                        <label for="message" class="block text-sm font-medium text-gray-700 mb-2">{{#if isFrench}}Message *{{else}}Message *{{/if}}</label>
                        <textarea name="message" id="message" rows="5" required
                                  placeholder="{{#if isFrench}}Parlez-nous de vos besoins en mÃ©taux prÃ©cieux...{{else}}Tell us about your precious metals needs...{{/if}}"
                                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gold focus:border-transparent"></textarea>
                    </div>
                    
                    <!-- Honeypot field -->
                    <div class="website-field">
                        <label for="website">Website</label>
                        <input type="text" name="website" id="website" tabindex="-1" autocomplete="off">
                    </div>
                    
                    <!-- Custom Captcha -->
                    <div>
                        <div class="custom-captcha" id="customCaptcha" onclick="verifyCaptcha()">
                            <div class="captcha-checkbox">
                                <svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <!-- Box -->
                                    <rect x="1" y="1" width="26" height="26" rx="4" stroke="#D4AF37" stroke-width="2" fill="white"/>
                                    <!-- Checkmark -->
                                    <path class="captcha-checkmark" d="M7 14L11 18L21 8" stroke="#10b981" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <span class="captcha-text">{{#if isFrench}}Je ne suis pas un robot{{else}}I'm not a robot{{/if}}</span>
                        </div>
                    </div>
                    
                    <button type="submit" class="w-full btn-primary" id="submitButton" disabled>
                        {{#if isFrench}}Envoyer{{else}}Submit{{/if}}
                    </button>
                </form>

                <!-- Company Information Footer -->
                <div class="mt-12 text-center text-gray-700">
                    <p class="font-semibold text-lg mb-2">Edelmetall Cham</p>
                    <p class="text-sm mb-1">{{#if isFrench}}reprÃ©sentÃ© par{{else}}represented by{{/if}} Franz Thums</p>
                    <p>Obere RegenstraÃŸe 9</p>
                    <p>93413 Cham, Germany</p>
                    <p class="mt-3">{{#if isFrench}}TÃ©lÃ©phone{{else}}Phone{{/if}}: <a href="tel:+49 (0) 9971 7273" class="text-gold hover:underline">+49 (0) 9971 7273</a></p>
                    <p>Email: <a href="mailto:info@edelmetallhandel-cham.de" class="text-gold hover:underline">info@edelmetallhandel-cham.de</a></p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-black">
        <div class="mx-auto max-w-7xl overflow-hidden px-6 py-20 sm:py-24 lg:px-8">
            <!-- Navigation Links -->
            <nav aria-label="Footer" class="-mb-6 flex flex-wrap justify-center gap-x-12 gap-y-3 text-sm">
                <a href="{{#if isFrench}}/fr/contact.html{{else}}/contact.html{{/if}}" class="text-gray-400 hover:text-gold transition">{{#if isFrench}}Contact{{else}}Contact{{/if}}</a>
                <a href="{{#if isFrench}}/fr/imprint.html{{else}}/imprint.html{{/if}}" class="text-gray-400 hover:text-gold transition">{{#if isFrench}}Mentions lÃ©gales{{else}}Imprint{{/if}}</a>
                <a href="{{#if isFrench}}/fr/privacy.html{{else}}/privacy.html{{/if}}" class="text-gray-400 hover:text-gold transition">{{#if isFrench}}Politique de confidentialitÃ©{{else}}Privacy Policy{{/if}}</a>
            </nav>

            <!-- Contact Icons -->
            <div class="mt-16 flex justify-center gap-x-10">
                <!-- Email -->
                <a href="mailto:info@edelmetallhandel-cham.de" class="text-gray-400 hover:text-gold transition">
                    <span class="sr-only">Email</span>
                    <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                    </svg>
                </a>

                <!-- Phone -->
                <a href="tel:+49 (0) 9971 7273" class="text-gray-400 hover:text-gold transition">
                    <span class="sr-only">{{#if isFrench}}TÃ©lÃ©phone{{else}}Phone{{/if}}</span>
                    <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                    </svg>
                </a>
            </div>

            <!-- Copyright & Address -->
            <div class="mt-10 text-center text-sm text-gray-400">
                <p class="mb-2">Â© 2025 Edelmetall Cham Â· Franz Thums</p>
                <p>Obere RegenstraÃŸe 9 Â· 93413 Cham Â· Germany</p>
                <p class="mt-2">
                    <a href="tel:+49 (0) 9971 7273" class="hover:text-gold transition">+49 (0) 9971 7273</a> Â·
                    <a href="mailto:info@edelmetallhandel-cham.de" class="hover:text-gold transition">info@edelmetallhandel-cham.de</a>
                </p>
            </div>
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        }

        // Captcha verification
        let captchaVerified = false;
        function verifyCaptcha() {
            const captcha = document.getElementById('customCaptcha');
            const submitButton = document.getElementById('submitButton');
            
            if (!captchaVerified) {
                captcha.classList.add('verified');
                captchaVerified = true;
                submitButton.disabled = false;
                
                // Store verification timestamp
                sessionStorage.setItem('captchaVerified', Date.now());
            }
        }

        // Check if captcha was recently verified (within 5 minutes)
        window.addEventListener('DOMContentLoaded', function() {
            const verifiedTime = sessionStorage.getItem('captchaVerified');
            if (verifiedTime && (Date.now() - parseInt(verifiedTime)) < 300000) {
                const captcha = document.getElementById('customCaptcha');
                const submitButton = document.getElementById('submitButton');
                captcha.classList.add('verified');
                captchaVerified = true;
                submitButton.disabled = false;
            }
        });

        // Contact form handling with mobile timeout fix
        const contactForm = document.getElementById('contactForm');
        if (contactForm) {
            contactForm.addEventListener('submit', async function(e) {
                e.preventDefault();

                // Check honeypot
                const honeypot = document.getElementById('website');
                if (honeypot && honeypot.value) {
                    console.log('Bot detected');
                    return;
                }

                // Check captcha
                if (!captchaVerified) {
                    alert('{{#if isFrench}}Veuillez vÃ©rifier que vous n\'Ãªtes pas un robot{{else}}Please verify that you are not a robot{{/if}}');
                    return;
                }

                const submitButton = this.querySelector('button[type="submit"]');
                const originalButtonText = submitButton.innerHTML;
                const formElement = this;
                const sectionElement = document.getElementById('contactSection');

                // Show loading state
                submitButton.innerHTML = `
                    <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-gray-900 inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    {{#if isFrench}}Envoi en cours...{{else}}Submitting...{{/if}}
                `;
                submitButton.disabled = true;

                // Create AbortController for timeout
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 30000); // 30 second timeout

                try {
                    // Get form data
                    const formData = new FormData(this);
                    const contactData = {
                        name: formData.get('name'),
                        email: formData.get('email'),
                        phone: formData.get('phone'),
                        message: formData.get('message'),
                        captchaVerified: captchaVerified,
                        timestamp: Date.now()
                    };

                    // Submit form with timeout
                    const response = await fetch('/api/submit-contact', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(contactData),
                        signal: controller.signal
                    });

                    clearTimeout(timeoutId);
                    const result = await response.json();

                    if (result.success) {
                        // Replace entire section for mobile compatibility
                        if (sectionElement) {
                            sectionElement.innerHTML = `
                                <div class="container mx-auto px-6">
                                    <div class="max-w-2xl mx-auto">
                                        <div style="text-align: center; padding: 60px 20px; min-height: 400px; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                                            <div style="display: inline-flex; align-items: center; justify-content: center; width: 80px; height: 80px; background-color: #dcfce7; border-radius: 50%; margin-bottom: 30px;">
                                                <svg style="width: 40px; height: 40px; color: #16a34a;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                                </svg>
                                            </div>
                                            <h2 style="font-size: 36px; font-weight: bold; color: #111827; margin-bottom: 16px; font-family: 'Open Sans', sans-serif;">{{#if isFrench}}Message envoyÃ© avec succÃ¨s!{{else}}Message Sent Successfully!{{/if}}</h2>
                                            <p style="font-size: 18px; color: #4b5563; margin-bottom: 32px; max-width: 500px; line-height: 1.6;">{{#if isFrench}}Merci de nous avoir contactÃ©s. Nous avons reÃ§u votre message et vous rÃ©pondrons dans les 24 Ã  48 heures.{{else}}Thank you for contacting us. We have received your message and will get back to you within 24-48 hours.{{/if}}</p>
                                            <p style="font-size: 14px; color: #6b7280; margin-bottom: 32px;">{{#if isFrench}}ID de rÃ©fÃ©rence{{else}}Reference ID{{/if}}: <strong>${result.submissionId || 'CONT-' + Date.now()}</strong></p>
                                            <div style="display: flex; gap: 16px; justify-content: center; flex-wrap: wrap;">
                                                <button onclick="window.location.href='{{#if isFrench}}/fr{{else}}/{{/if}}'" style="display: inline-block; background-color: transparent; color: #111827; padding: 16px 32px; border-radius: 8px; font-weight: 600; text-decoration: none; font-size: 16px; transition: all 0.2s; border: 2px solid #d4af37; cursor: pointer;">
                                                    {{#if isFrench}}Retour Ã  l'accueil{{else}}Go Back to Home{{/if}}
                                                </button>
                                                <button onclick="window.location.reload()" style="display: inline-block; background-color: #d4af37; color: #111827; padding: 16px 32px; border-radius: 8px; font-weight: 600; text-decoration: none; font-size: 16px; transition: background-color 0.2s; border: none; cursor: pointer;">
                                                    {{#if isFrench}}Envoyer un autre message{{else}}Send Another Message{{/if}}
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `;
                        }
                        
                        // Also hide the form as backup
                        formElement.style.display = 'none';
                        
                        // Clear captcha verification
                        sessionStorage.removeItem('captchaVerified');
                    } else {
                        // Show error message
                        alert(result.message || '{{#if isFrench}}Une erreur est survenue. Veuillez rÃ©essayer.{{else}}An error occurred. Please try again.{{/if}}');
                        submitButton.innerHTML = originalButtonText;
                        submitButton.disabled = !captchaVerified;
                    }
                } catch (error) {
                    clearTimeout(timeoutId);
                    
                    if (error.name === 'AbortError') {
                        alert('{{#if isFrench}}La soumission a expirÃ©. Veuillez vÃ©rifier votre connexion et rÃ©essayer.{{else}}Submission timed out. Please check your connection and try again.{{/if}}');
                    } else {
                        console.error('Error submitting form:', error);
                        alert('{{#if isFrench}}Impossible de soumettre le formulaire. Veuillez vÃ©rifier votre connexion et rÃ©essayer.{{else}}Failed to submit form. Please check your connection and try again.{{/if}}');
                    }
                    submitButton.innerHTML = originalButtonText;
                    submitButton.disabled = !captchaVerified;
                }
            });
        }
    </script>
</body>
</html>